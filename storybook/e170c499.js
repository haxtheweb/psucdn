System.register(["./734b9790.js"],(function(e){"use strict";var t,o,n,r,l,i,a,s;return{setters:[function(c){t=c._,o=c.a,n=c.a$,r=c.c,l=c.d,i=c.b0,a=c.j,s=c.k,e({FileSystemBroker:c.a$,FileSystemBrokerSingleton:c.b1})}],execute:function(){var c={url:new URL("./elements/file-system-broker/lib/docx-file-system-broker.js",document.baseURI).href},m=e("DOCXFileSystemBroker",function(e){function n(){var e;return r(this,n),(e=l(this,n)).libPath=new URL("./docx-file-system-broker.js",c.url).href+"/../",e.libPath+="mammoth/",i.load("mammoth",e.libPath+"mammoth.browser.min.js").then((function(){globalThis.mammoth&&(e.docx=globalThis.mammoth,e.dispatchEvent(new CustomEvent("docx-reader-ready",{bubbles:!0,composed:!0,cancelable:!1,detail:e})))})),e}return t(n,e),o(n,[{key:"__toHTML",value:function(e,t){globalThis.dispatchEvent(new CustomEvent("docx-file-system-data",{composed:!1,bubbles:!1,cancelable:!0,detail:{name:t,value:e.value}}))}},{key:"HTMLToDOCX",value:function(e,t){var o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n="<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'>\n      <head>\n        <meta charset='utf-8'>\n        <title>".concat(t,"</title>\n      </head>\n      <body>\n      ").concat(e,"\n      </body>\n    </html>");if(o){var r=globalThis.document.createElement("a");globalThis.document.body.appendChild(r),r.href="data:application/vnd.ms-word;charset=utf-8,"+encodeURIComponent(n),r.download="".concat(t,".docx"),r.click(),globalThis.document.body.removeChild(r)}return n}},{key:"fileToHTML",value:function(e){var t=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"filepicked",n=new FileReader;n.onload=function(){var e=a(s().mark((function e(n){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.docx.convertToHtml({arrayBuffer:n.target.result}).then((function(e){return t.__toHTML(e,o)})).done();case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.readAsBinaryString(e)}}],[{key:"tag",get:function(){return"docx-file-system-broker"}}])}(n));customElements.define(m.tag,m),globalThis.DOCXFileSystemBroker=globalThis.DOCXFileSystemBroker||{},globalThis.DOCXFileSystemBroker.requestAvailability=function(){return globalThis.DOCXFileSystemBroker.instance||(globalThis.DOCXFileSystemBroker.instance=globalThis.document.createElement("docx-file-system-broker"),globalThis.document.body.appendChild(globalThis.DOCXFileSystemBroker.instance)),globalThis.DOCXFileSystemBroker.instance};e("DOCXFileSystemBrokerSingleton",globalThis.DOCXFileSystemBroker.requestAvailability())}}}));
