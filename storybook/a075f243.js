System.register(["./3826c3d9.js","./570f6f8e.js","./f1fe169d.js"],(function(e,t){"use strict";var a,n,o,i,s,l,r,c,d,h,m,u,p,g,f,b,v,y,x,T,k,_,C,w;return{setters:[function(e){a=e._,n=e.a,o=e.g,i=e.b,s=e.e,l=e.f,r=e.x,c=e.K,d=e.t,h=e.O,m=e.a0,u=e.aM,p=e.n,g=e.a8,f=e.aN,b=e.aO,v=e.u,y=e.V,x=e.i,T=e.c,k=e.d,_=e.p,C=e.h,w=e.j},function(){},function(){}],execute:function(){var L,S,E={url:new URL("./elements/haxcms-elements/lib/core/haxcms-site-builder.js",document.baseURI).href};function I(e){e.matches?h.darkMode=!0:h.darkMode=!1}var A=e("HAXCMSSiteBuilder",function(e){function y(){var e;for(var t in T(this,y),(e=k(this,y)).__pageContent="",e.windowControllers=new AbortController,e.t=s(s({},l(y,"t",e,1)),{},{pageNotFound:"Page not found",navigateToAnotherPageInTheMenu:"Navigate to another page in the menu",couldNotBeLocated:"could not be located",hereAreSomePossibleRemedies:"Here are some possible remedies:",useSearchToLocateTheContentYouAreLookingFor:"Use Search to locate the content you are looking for",goToTheHomePage:"Go to the home page"}),e.registerLocalization({context:e,namespace:"haxcms",localesPath:new URL("../../locales/haxcms.es.json",E.url).href.replace("/haxcms.es.json","/"),locales:["es"]}),e._timeStamp=Math.floor(Date.now()/1e3),e.disableFeatures="",e.isLoggedIn=!1,e.__disposer=[],e.queryParams={},e.loading=!1,e.__imported={},e.themeLoaded=!1,e.outlineLocation="",e.activeItemLocation="",u.storePieces.siteBuilder=e,e.children)if(e.children[t].tagName&&e.children[t].getAttribute("slot")){var a=e.children[t].cloneNode(!0),n=a.getAttribute("slot");switch(n){case"haxcms-site-editor-ui-prefix-avatar":case"haxcms-site-editor-ui-prefix-buttons":case"haxcms-site-editor-ui-suffix-buttons":case"haxcms-site-editor-ui-main-menu":case"haxcms-site-editor-ui-topbar-character-button":h.setupSlots[n].push(a)}}return globalThis.addEventListener("hax-store-ready",e.storeReady.bind(e),{signal:e.windowControllers.signal}),globalThis.addEventListener("haxcms-trigger-update",e._triggerUpdatedData.bind(e),{signal:e.windowControllers.signal}),globalThis.addEventListener("haxcms-trigger-update-node",e._triggerUpdatedNode.bind(e),{signal:e.windowControllers.signal}),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",I,{signal:e.windowControllers.signal}),p((function(){_("app-hax-darkMode",d(h.darkMode)),d(h.darkMode)?globalThis.document.body.classList.add("dark-mode"):globalThis.document.body.classList.remove("dark-mode")})),p((function(){e.isLoggedIn=d(h.isLoggedIn);var t=Math.floor(Date.now()/1e3);e.isLoggedIn&&!e.loggedInTime&&(e.loggedInTime=t,e._timeStamp=e.loggedInTime)})),e}return a(y,e),n(y,[{key:"render",value:function(){return r(L||(L=i(['\n      <site-ai-chat></site-ai-chat>\n      <haxcms-site-router base-uri="','"></haxcms-site-router>\n      <simple-progress .disabled="','"></simple-progress>\n      <div id="slot"><slot></slot></div>\n      <slot name="haxcms-site-editor-ui-prefix-avatar"></slot>\n      <slot name="haxcms-site-editor-ui-prefix-buttons"></slot>\n      <slot name="haxcms-site-editor-ui-suffix-buttons"></slot>\n      <slot name="haxcms-site-editor-ui-main-menu"></slot>\n      <slot name="haxcms-site-editor-ui-topbar-character-button"></slot>\n    '])),this.baseURI,!this.loading)}},{key:"_updateManifest",value:function(e){this.manifest=s({},e)}},{key:"_updateLoading",value:function(e){this.loading=e.detail.value}},{key:"hashCode",value:function(e){return e.split("").reduce((function(e,t){return 0|(e=(e<<5)-e+t.charCodeAt(0))}),0)}},{key:"nodeNormalizeIDs",value:function(e){if(e.tagName&&null==e.getAttribute("id")&&["H1","H2","H3","H4","H5","H6"].includes(e.tagName))if(e.getAttribute("resource"))e.setAttribute("id",e.getAttribute("resource"));else{var t=e.tagName.toLowerCase()+"-"+this.hashCode(e.innerText);e.setAttribute("id",t)}}},{key:"_updateActiveItemContent",value:function(e){if(e){var t=globalThis.document.createElement("div");t.innerHTML=e;var a,n=c(t.childNodes);try{for(n.s();!(a=n.n()).done;){var o=a.value;this.nodeNormalizeIDs(o)}}catch(e){n.e(e)}finally{n.f()}e=t.innerHTML,this.__pageContent=e,this._activeItemContentChanged(this.__pageContent,d(h.activeItem))}else h.cmsSiteEditorBackend.instance&&h.cmsSiteEditorBackend.instance.updateActiveItemContent&&h.cmsSiteEditorBackend.instance.updateActiveItemContent()}},{key:"display404Error",value:function(){if(h.themeElement){var e=globalThis.document.createDocumentFragment(),t=globalThis.document.createElement("p");t.innerHTML="<strong>".concat(h.getInternalRoute(),"</strong> ").concat(this.t.couldNotBeLocated,". ").concat(this.t.hereAreSomePossibleRemedies,'\n      <ul>\n        <li><a href="x/search?search=').concat(h.getInternalRoute(),'">').concat(this.t.useSearchToLocateTheContentYouAreLookingFor,'</a></li>\n        <li><a href="./">').concat(this.t.goToTheHomePage,"</a></li>\n        <li>").concat(this.t.navigateToAnotherPageInTheMenu,"</li>\n      </ul>"),e.appendChild(t),m(h.themeElement,"*"),h.themeElement.appendChild(e)}}},{key:"renderInternalRoute",value:function(){if(h.themeElement){var e=globalThis.document.createDocumentFragment();h.activeItem.component&&t.import("../ui-components/routes/".concat(h.activeItem.component,".js")).then((function(){var t=globalThis.document.createElement(h.activeItem.component);e.appendChild(t),m(h.themeElement,"*"),h.themeElement.appendChild(e)}))}}},{key:"loadPageData",value:(A=C(w().mark((function e(){var t,a=this;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.activeItemLocation||this.loading){e.next=11;break}if(this.loading=!0,t="".concat(this.outlineLocation).concat(this.activeItemLocation),this._timeStamp&&(-1!=t.indexOf("?")?t+="&".concat(this._timeStamp):t+="?".concat(this._timeStamp)),"hax-internal-route.html"!==this.activeItemLocation){e.next=9;break}this.renderInternalRoute(),this.loading=!1,e.next=11;break;case 9:return e.next=11,fetch(t).then((function(e){if(e.ok)return e.text();a.display404Error()})).then((function(e){a._updateActiveItemContent(e),a.loading=!1})).catch((function(e){a.lastErrorChanged(e)}));case 11:case"end":return e.stop()}}),e,this)}))),function(){return A.apply(this,arguments)})},{key:"loadJOSData",value:(x=C(w().mark((function e(){var t,a,n,o=this;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.file){e.next=15;break}this.loading=!0,t="".concat(this.outlineLocation).concat(this.file),e.prev=3,a=JSON.parse(this.file),this._updateManifest(a),this.loading=!1,e.next=15;break;case 9:return e.prev=9,e.t0=e.catch(3),this._timeStamp&&""!=this._timeStamp&&(-1!=t.indexOf("?")?t+="&".concat(this._timeStamp):t+="?".concat(this._timeStamp)),n={cache:"no-cache"},e.next=15,fetch(t,n).then((function(e){if(e.ok)return e.json()})).then((function(e){o._updateManifest(e),o.loading=!1})).catch((function(e){o.lastErrorChanged(e)}));case 15:case"end":return e.stop()}}),e,this,[[3,9]])}))),function(){return x.apply(this,arguments)})},{key:"updated",value:function(e){var t=this;l(y,"updated",this,1)&&l(y,"updated",this,3)([e]);var a=!1,n=!1;e.forEach((function(e,o){["outlineLocation","activeItemLocation"].includes(o)&&""!=t[o]&&(n=!0),["outlineLocation","file"].includes(o)&&""!=t[o]&&(a=!0),"_timeStamp"==o&&t[o]&&(a=!0,n=!0),"themeData"==o?t._themeChanged(t[o],e):"themeName"==o?t._themeNameChanged(t[o],e):"outlineLocation"==o?t.dispatchEvent(new CustomEvent("outline-location-changed",{bubbles:!0,cancelable:!0,composed:!0,detail:t[o]})):"manifest"==o&&(t.dispatchEvent(new CustomEvent("manifest-changed",{bubbles:!0,cancelable:!0,composed:!0,detail:t[o]})),t._manifestChanged(t[o],e))})),a&&this.__ready&&this.loadJOSData(),n&&this.__ready&&this.loadPageData()}},{key:"_themeNameChanged",value:function(e){e&&(h.themeElement&&h.themeElement.remove(),m(this,"*"),h.themeElement=globalThis.document.createElement(e),h.themeElement.classList.add("haxcms-theme-element"),this.appendChild(h.themeElement))}},{key:"lastErrorChanged",value:function(e){e&&(console.error(e),e.detail&&e.detail.value?(globalThis&&globalThis.location&&globalThis.appSettings&&globalThis.appSettings.reloadOnError&&globalThis.location.reload(),h.toast(e.detail.value.status+" "+e.detail.value.statusText,5e3,{fire:!0})):globalThis&&globalThis.location&&globalThis.appSettings&&globalThis.appSettings.reloadOnError&&globalThis.location.reload())}},{key:"displayConsoleWarning",value:function(){setTimeout((function(){console.warn("%c‚ö†Ô∏èSTOP‚ö†Ô∏è","color: white; font-weight: bold; font-size: 5em;font-family: arial; background-color: darkred; border: 5px solid white; border: 5px solid white;"),console.warn('%cThis is a browser feature intended for developers. If someone told you to copy and paste something here to enable a hidden feature or "hack" someone\'s account, it is a scam and will give them access to your account.',"font-size: 1.5em; font-family: arial; color: white; background-color: darkred; ")}),3500)}},{key:"displayConsoleLearnMore",value:function(){setTimeout((function(){console.log("%cüë©‚ÄçüíªHAXcmsüßë‚Äçüíª","color: white; font-weight: bold; padding: 10px; font-size: 5em;font-family: arial; background-color: black; border: 5px solid white; border: 5px solid white; font-style: italic;"),console.log("%cThis site was created using HAXcms.\nLearn more about HAXcms at https://hax.psu.edu/.","color: white; background-color: black; font-size: 1.5em; font-family: arial; padding: 10px;")}),3e3)}},{key:"firstUpdated",value:function(e){var a=this;l(y,"firstUpdated",this,1)&&l(y,"firstUpdated",this,3)([e]),this.displayConsoleLearnMore(),this.__ready=!0,h.appReady=!0,globalThis.dispatchEvent(new CustomEvent("haxcms-ready",{bubbles:!0,composed:!0,cancelable:!1,detail:this})),t.import("./93ba8243.js").then((function(e){t.import("./47a2c4eb.js"),a.editorBuilder=globalThis.document.createElement("haxcms-editor-builder"),a.parentNode?a.parentNode.insertBefore(a.editorBuilder,a):globalThis.document.body.appendChild(a.editorBuilder),"published"!==u.getApplicationContext()?a._timeStamp=Math.floor(Date.now()/1e3):a._timeStamp=""})).catch((function(e){console.warn(e)})),globalThis.dispatchEvent(new Event("resize")),setTimeout((function(){p((function(e){if(a.themeData=d(h.themeData),a.themeData){var t=new URLSearchParams(globalThis.location.search),n=t.get("format");if(null!=n&&"print-page"===n)a.themeData.element="haxcms-print-theme";var o=t.get("disable-features");null!=o&&(a.disableFeatures=o)}a.themeData&&a.themeData.element!==a.themeName&&(a.themeName=a.themeData.element),a.__disposer.push(e)})),p((function(e){var t=d(h.activeItem);t&&a.__pageContent&&a._activeItemContentChanged(a.__pageContent,t),t&&t.location&&(a.activeItemLocation=t.location,a.loadPageData()),a.__disposer.push(e)}))}),0)}},{key:"disconnectedCallback",value:function(){for(var e in this.__disposer)this.__disposer[e].dispose();this.windowControllers.abort(),l(y,"disconnectedCallback",this,3)([])}},{key:"storeReady",value:function(e){h.cmsSiteEditor&&h.cmsSiteEditor.instance&&globalThis.HaxStore.requestAvailability().activeHaxBody&&h.activeItemContent&&globalThis.HaxStore.requestAvailability().activeHaxBody.importContent(h.activeItemContent)}},{key:"replaceTagReplacement",value:function(e){for(var t=/\<(\w+?\-\w*.*)\s*?\>/gim,a=t.exec(e);null!=a;){var n=a[1].replace("<","").replace(">","");n.indexOf(" ")&&(n=n.split(" ")[0]),-1!=n.indexOf("-")&&(e=(e=e.replace("<"+n,'<replace-tag with="'+n+'" ')).replace("</"+n+">","</replace-tag>")),a=t.exec(e)}return e}},{key:"_activeItemContentChanged",value:function(e,a){var n=this,o=e;null!==o&&a&&a.metadata&&(o='<page-break\n      break-type="site"\n      title="'.concat(a.title,'"\n      parent="').concat(a.parent,'"\n      item-id="').concat(a.id,'"\n      slug="').concat(a.slug,'"\n      description="').concat(a.description,'"\n      order="').concat(a.order,'"\n      ').concat(a.metadata.pageType?'page-type="'.concat(a.metadata.pageType,'"'):"","\n      ").concat(a.metadata.tags?'tags="'.concat(a.metadata.tags,'"'):"","\n      ").concat(a.metadata.hideInMenu?'hide-in-menu="hide-in-menu"':"","\n      ").concat(a.metadata.relatedItems?'related-items="'.concat(a.metadata.relatedItems,'"'):"","\n      ").concat(a.metadata.image?'image="'.concat(a.metadata.image,'"'):"","\n      ").concat(a.metadata.icon?'icon="'.concat(a.metadata.icon,'"'):"","\n      ").concat(a.metadata.accentColor?'accent-color="'.concat(a.metadata.accentColor,'"'):"","\n      ").concat(a.metadata.theme&&a.metadata.theme.key?'developer-theme="'.concat(a.metadata.theme.key,'"'):"","\n      ").concat(a.metadata.locked?'locked="locked"':"","\n      ").concat(!1===a.metadata.published?"":'published="published"'," ></page-break>").concat(o),o=g(o),m(h.themeElement,"*"),h.activeItemContent=o,setTimeout((function(){if(0===h.themeElement.childNodes.length){var e=document.createRange().createContextualFragment(n.replaceTagReplacement(o));h.themeElement.appendChild(e),n.dispatchEvent(new CustomEvent("json-outline-schema-active-body-changed",{bubbles:!0,composed:!0,cancelable:!1,detail:o}))}if(!globalThis.WCAutoload&&f(n.manifest,"metadata.node.dynamicElementLoader")){var a=b(o),i=new URL("../../locales/haxcms.es.json",E.url).href+"/../";for(var s in a){var l=a[s];n.manifest.metadata.node.dynamicElementLoader[l]&&!globalThis.customElements.get(l)&&t.import("".concat(i,"../../../../").concat(n.manifest.metadata.node.dynamicElementLoader[l])).then((function(e){})).catch((function(e){console.warn(e)}))}}else globalThis.WCAutoload&&setTimeout((function(){globalThis.WCAutoload.process()}),0)}),5))}},{key:"_triggerUpdatedData",value:function(e){this.isLoggedIn?this._timeStamp=Math.floor(Date.now()/1e3):this._timeStamp=""}},{key:"_triggerUpdatedNode",value:function(e){this.loadPageData()}},{key:"_manifestChanged",value:function(e,t){e&&e.metadata&&e.items&&h.loadManifest(e,this)}},{key:"_themeChanged",value:function(e,a){var n=this;if(e){this.themeLoaded=!1;var o=e;if("undefined"!==v(this.__imported[o.element]))this.themeLoaded=!0;else if(globalThis.WCAutoload)this.__imported[o.element]=o.element,this.themeLoaded=!0,setTimeout((function(){globalThis.WCAutoload.process(),globalThis.dispatchEvent(new CustomEvent("haxcms-theme-ready",{bubbles:!0,composed:!0,cancelable:!1,detail:n}))}),5);else try{t.import(new URL("./../../../../../"+e.path,E.url).href).then((function(e){n.__imported[o.element]=o.element,n.themeLoaded=!0}))}catch(e){this.themeLoaded=!0}}}}],[{key:"styles",get:function(){return[o(S||(S=i(["\n        :host {\n          display: block;\n          position: relative;\n        }\n        :host([is-logged-in]) {\n          max-height: calc(100vh - 56px);\n        }\n        :host #slot {\n          opacity: 0.2;\n          visibility: hidden;\n        }\n        :host([theme-loaded]) #slot {\n          opacity: 1;\n          visibility: visible;\n        }\n        simple-progress {\n          display: block;\n          width: 100%;\n          position: fixed;\n          top: 0;\n          left: 0;\n          right: 0;\n          background-color: transparent;\n          z-index: 1000;\n          --simple-progress-active-color: var(\n            --haxcms-color,\n            rgba(255, 255, 255, 0.5)\n          );\n        }\n        simple-progress[disabled] {\n          display: none;\n        }\n      "])))]}},{key:"tag",get:function(){return"haxcms-site-builder"}},{key:"properties",get:function(){return s(s({},l(y,"properties",this)),{},{activeItemLocation:{type:String,attribute:"active-item-location"},disableFeatures:{type:String,reflect:!0,attribute:"disable-features"},_timeStamp:{type:String},isLoggedIn:{type:Boolean,reflect:!0,attribute:"is-logged-in"},queryParams:{type:Object},loading:{type:Boolean,reflect:!0},outlineLocation:{type:String,attribute:"outline-location"},manifest:{type:Object},themeData:{type:Object},themeName:{type:String},__imported:{type:Object},themeLoaded:{type:Boolean,reflect:!0,attribute:"theme-loaded"},file:{type:String},baseURI:{type:String,attribute:"base-uri"}})}}]);var x,A}(y(x)));globalThis.HAXme=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null==e&&(e="demo",globalThis.appSettings={login:"dist/dev/login.json",logout:"dist/dev/logout.json",saveNodePath:"dist/dev/saveNode.json",saveManifestPath:"dist/dev/saveManifestPath.json",createNodePath:"dist/dev/saveNode.json",deleteNodePath:"dist/dev/saveNode.json",saveOutlinePath:"dist/dev/saveNode.json",getSiteFieldsPath:"dist/dev/getSiteFieldsPath.json",getFormToken:"adskjadshjudfu823u823u8fu8fij",appStore:{url:"dist/dev/appstore.json"},jwt:"made-up-thing",themes:{"haxcms-dev-theme":{element:"haxcms-dev-theme",path:"@haxtheweb/haxcms-elements/lib/haxcms-dev-theme.js",name:"Developer theme"}}}),"demo"==e&&(globalThis.HAXCMSContext="demo"),globalThis.document.body&&(globalThis.document.body.querySelector("haxcms-editor-builder").__appliedContext=!1,globalThis.document.body.querySelector("haxcms-editor-builder").applyContext(e))},globalThis.customElements.define(A.tag,A)}}}));
